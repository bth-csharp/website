---
title: "Skapa terminalprogram"
description: Övning för att skapa ett terminalprogram
sidebar:
    order: 4
---

import Figure from '@components/CustomFigure.astro';

import fileStructure from '@assets/img/kmom01/fileStructure.png';
import titleWindow from '@assets/img/kmom01/titleWindow.png';
import debug_start from '@assets/img/kmom01/debug_start.png';

## Skapa app

Vi börjar med att skapa vårt första terminalprogram eller konsol-app (console app) som det kallas i C#. Det är en default-app från dotnet, som skriver ut "Hello, World!" i terminalen.

### I terminalen

Vi ställer oss i kmom01 och  med **dotnet** skapar vi vårt första terminalprogram som vi kallar *FirstApp*. Det tar en liten stund. Katalogen *FirstApp* kallas C#-projekt eller applikation.

```bash
pwd // stå i kmom01 (terminalen)
dotnet new console -n FirstApp
```

När vi kör appen så kompileras koden och appen byggs. Det tar en stund att kompilera koden. För att köra appen:

```bash
cd FirstApp
dotnet run
// Ger utskriften: Hello, World!
```

### I VS code

Vi öppnar vårt terminalprogram i VS code för att titta på koden. Det är här vi uppdaterar vår kod.

{/*När projektet öppnas första gången i VS Code så kan detta dyka upp i nedre högra hörnet: 
"Required assets to build and debug are missing. Add them?"  
Välj Yes.  */}

## Filstruktur i vår app

Så här ser filstrukturen ut i vår app.

<Figure
    src={fileStructure}
    caption="Filstruktur för FirstApp."
    width="400px"
/>

- **Program.cs** vårt huvudprogram (main) som innehåller vår kod. I det här fallet motsvarar koden bara en utskrift. När du startar ditt terminalprogram med "dotnet run" så körs denna kod.
- **FirstApp.csproj**, håller reda på ditt projekt. Den innehåller information om projektets struktur samt vilka filer som ska inkluderas och vilka beroenden projektet har. Filen har samma namn som vårt projekt med ".csproj" på slutet.
- **obj**, är en katalog med temporära filer som innehåller filer som skapas under kompileringen
- **bin**, innehåller binärfiler, det vill säga den slutgiltiga programkoden som gör att ditt terminalprogram kan köras.

{/* Ibland finns också: OBS detta är Visual Studio specifikt
- Properties, innehåller projektrelaterade egenskaper, till exempel AssemblyInfo.cs, som innehåller metadata om ditt projekt.
- FirstApp.sin, "solution file" innehåller information om din app, som namnet på appen för att strukturera appen i Visual Studio. SKA JAG HA DENNA??? -->
 */}
## Lägg till kod

Titta gärna i dokumentationen för mer detaljer om C#. Här är en [C# snabbreferens](https://csharp.progdocs.se/). Du kan gärna titta i snabbreferensen om kodtips men fortsätt skapa appar i terminalen som vi gjorde ovan.

### Övning 1 - skriv ut slumptal mellan 1 och 100

Vi öppnar vårt huvudprogram, Program.cs, i VS code och lägger till följande kod i slutet:

```csharp
// i kmom01/FirstApp/Program.cs
// Create random class
Random random = new Random();

// Get random value from 1 (1 included) up to 101 (101 not included)
int number1 = random.Next(1, 101);
int number2 = random.Next(1, 101);

// Present the two random values
Console.WriteLine("\nFirst random value: " + number1);
Console.WriteLine("Second random value: " + number2);
```

### Övning 2 - lägg till en if-sats

Vi lägger till en if-sats som skriver ut om personen är myndig eller inte utifrån ålder. För att inte vi ska störas av tidigare kod så rensar vi terminalen och ger den en titel ""Min första C# app". Eftersom inmatning via `ReadLine()` från användaren kan vara tom, så lägger vi till ett defaultvärde som i det här fallet är "1".

Vi lägger till följande kod i slutet vårt huvudprogram, Program.cs:

```csharp
// i kmom01/FirstApp/Program.cs
// Clean console och sätt titel
Console.Clear();
Console.Title = "Min första C# app";

// Input
Console.WriteLine("\nVilken är din ålder?");
string input = Console.ReadLine() ?? "1"; // input får defaultvärdet "1" om inget matas in
int age = int.Parse(input);

// Check age
string message;
if (age < 18) 
{
    message = "Du är inte myndig";
} 
else 
{
    message = "Grattis - du är myndig";
}

// Present the result
Console.WriteLine("\n" + message);
```

Nu har vi rensat terminalen, så "Hello, world!" och slumptalen syns inte längre. Vi har lagt till en titel på vårt terminalfönster. Så här ser det ut från en Mac:

<Figure
    src={titleWindow}
    caption="Terminalen efter if-satsen i FirstApp."
/>


### Övning 3 - gör en metod och använd den

Nu ska vi göra en funktion som innehåller vår if-sats för att kunna använda den kodsnutten flera gånger. Metoden ska returnera en sträng. Inmatningen är samma som innan men vi flyttar vår if-sats till en metod. Vi gör också en metod av kommandona till terminalen.

```csharp
// i kmom01/FirstApp/Program.cs
// Methods
static void GetTerminalReady(string title)
{
    Console.Clear();
    Console.Title = title;
}

static string CheckIfAdult(int age)
{
    if (age < 18) 
    {
        return "Du är inte myndig";
    } 
    else 
    {
        return "Grattis - du är myndig";
    }
}

// Input
GetTerminalReady("Min första C# app");
Console.WriteLine("\nVilken är din ålder?");
string input = Console.ReadLine() ?? "1";
int age = int.Parse(input);

// Call method
string message = CheckIfAdult(age);

// Present the result
Console.WriteLine("\n" + message);
```

Resultatet ska bli detsamma som i föregående övning men nu med metoder.


### Övning 4 - Interpolerande strängar

Nu fortsätter vi att utforska C# med *interpolerande* strängar. Vi deklarerar en variabel för namn och en variabel för ålder vilka vi initierar och skriver ut. Därefter anropar vi metoden vi skrev ovan, `CheckIdAdult`, och skriver ut det i en interpolerande sträng.

```csharp
// i kmom01/FirstApp/Program.cs
// String interpolation
string firstName = "Murphy";
int age2 = 42;
string message2 = $"Du heter {firstName} och är {age2} år gammal.";
Console.WriteLine("\n" + message2);
Console.WriteLine($"\n{CheckIfAdult(age2)}");
```

Om age2 ändras efter interpolationen i tilldelningen av message2, så påverkas inte innehållet i message2 utan message2 har samma innehåll som vid initieringen.


### Övning 5 - Tuples

I nyare versionen av C# finns *tuples*. Vi deklarerar en ny variabel som är en tuple med en sträng och ett heltal. Vi använder firstName och age2 från förra övningen och  kopierar deras värden till tupeln och sedan skriver ut tupeln. Om vi vill komma åt första värdet i en tuple så använder vi `Item1`, för andra värdet `Item2` och så vidare. OBS räknandet börjar på 1 i tuples, till skillnad från index 0 i till exempel strängar.

```csharp
// i kmom01/FirstApp/Program.cs
// Tuples
(string, int) info = (firstName, age2);
Console.WriteLine($"\n{info}");
Console.WriteLine($"\n{info.Item2}");
```

### Övning 6 - Olika typer

I den här övningen ska vi träna på att omvandla mellan olika typer. Försök utföra följande typomvandlingar:

- omvandla 123 (int) till en float med implicit casting
- omvandla 123.123 (double) till en int med explicit casting
- omvandla double 123.123 till en sträng med klassen Convert
- omvandla "Hej" till en int med klassen Convert. Testa utan try-catch först.
- omvandla "Hej" till ett tal med int.TryParse
- omvandla "123" till ett tal med int.TryParse

```csharp
// i kmom01/FirstApp/Program.cs
// Cast and convert
int intNo = 123;
float floatNo = intNo;
Console.WriteLine($"\n{floatNo}");
Console.WriteLine($"{floatNo:F1}"); // skriv ut med en decimal

double doubleNo = 123.123;
int intNo2 = (int)doubleNo;
Console.WriteLine($"\n{intNo2}");

Console.WriteLine($"\n{Convert.ToString(doubleNo)}");

string hi = "Hej";
try 
{
    Console.WriteLine($"\n{Convert.ToInt32(hi)}");
} catch (Exception error)
{
    Console.WriteLine($"\nDet gick inte att konvertera {hi} med klassen Convert och ToInt32.");
    Console.WriteLine(error.Message);
}

int number;
bool success = int.TryParse(hi, out number);
Console.WriteLine($"\n{success} och numret blev {number}");

string strNo = "123";
bool success2 = int.TryParse(strNo, out number);
Console.WriteLine($"\n{success2} och numret blev {number}");
```


## Formatera koden

Vi kan formatera koden med verktyget `dotnet format` som formaterar enligt en standarduppsättning. Verktyget hjälper till att standardisera kodstilen och göra den konsekvent.
Stå i rotkatalogen till ett C#-projektet och kör kommandot i terminalen:

```shell
dotnet format
dotnet format -v d // ger mer info om formateringen
```

Läs mer om [dotnet format](https://learn.microsoft.com/en-us/dotnet/core/tools/dotnet-format).


### Debugging

För att debugga vår kod öppnar vi vårt projekt, det vill säga katalogen med vårt program, i VS Code. Markera filen Program.cs. Se bild nedan:

<Figure
    src={debug_start}
    caption="VS Code start debug."
/>


Klicka på symbolen för att starta debugging. För att skapa brytpunkter klickar du i vänsterkanten på den aktuella kodraden.


## Sammanfattning

Toppen, nu har vi lärt oss:

- skapa och köra vårt första C#-projekt (applikation, terminalprogram)
- lärt oss lite om filstrukturen i projektet
- koda in- och utmatning
- koda slumptal
- koda if-satser
- koda metoder
- hur vi enkelt kan formatera koden med kommandot "dotnet format"
- debugga vår kod
